name: Reusable workflow to prepare environment and run a cargo command

on:
  workflow_call:
    inputs:
      cargo-command:
        required: true
        type: string

env:
  CARGO_TERM_COLOR: always

jobs:
  run-cargo:

    runs-on: ubuntu-latest
    environment: Rust Crates

    steps:
      - name: Install alsa (needed for alsa-sys crate)
        run: sudo apt-get install alsa libasound2-dev libudev-dev
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Run ${{ inputs.cargo-command }}
        run: ${{ inputs.cargo-command }}